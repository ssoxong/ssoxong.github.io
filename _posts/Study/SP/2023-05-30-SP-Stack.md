---
title: "System Programming - Functions and Stack"
excerpt: "SP post"

categories:
    - SystemProgramming
tags:
  - [System, Programming, Stack]

toc: true
toc_sticky: true
 
date: 2023-05-30
last_modified_at: 2023-05-30
---

## Stack
- stack에는 function call과 automatic variable을 저장한다.  
- 메모리 주소의 위에서 아래로 할당한다. (top이 메모리 주소의 아래에 존재)  
- LIFO


## Stack 할당 과정
![image](https://github.com/ssoxong/ssoxong.github.io/assets/112956015/68dcd30f-9c3c-408e-ab64-2c2ebe8a73b6)


**automatic variable**
- 함수의 지역변수이며, 사용되기 전에 stack에 할당되어 있다. 
- 해당 function 끝날 때까지 stack에 유지한다. 
- 프로그래머들은 해당 변수의 위치나 순서를 예측하지 못한다. 
    - 어느 순서든 할당 가능하지만, 구조체의 경우는 순서가 고정되어있다. 

## function call
- 함수가 네스팅 가능한 경우, 한번에 하나의 함수만 호출할 수 있다.

- 과정
    1. 함수의 위치로 jump
    2. 해당 함수 실행
    3. 함수가 끝난 후 호출부로 jump
    - 여기서 지역변수를 할당하거나, 또다른 함수를 부르거나 등 여러 복잡성 존재

--> 이러한 경우, 함수는 stack frame이 필요하다.

## Stack Frames
A Stack frame holds information for a single function invocation.
- Saved processor registers
- 함수의 지역변수 저장
- 매개변수 저장
- 호출부의 주소 리턴

## Local Variables
모든 함수의 지역변수는 스택에 함꼐 할당된다. 
스택 프레임의 사이즈는 고정된 사이즈이며, 해당 사이즈는 저장되지 않는다. 컴파일러가 따로 관리한다. 

## Function Argument
함수의 매개변수.
6개까지는 레지스터에 저장하며 6개 이상은 스택에 저장한다. 
레지스터에 저장한 변수가 더 빠른 접근성을 가지기 때문에 가능하면 6개 이하로 지정하기..

-> 만약 함수 매개변수가 스택에 저장된다면, 반대 순서로 push된다. 

## Program Counter
함수 호출시 해당 PC값을 저장한다.
함수를 처리한다.
함수 종료시 PC값을 통해 호출부로 리턴한다. 
**PC**는 현재 실행중인 프로세스의 machine instruction 주소이다. 

## Summary
1. Automatic variables are allocated on the stack
2. The stack grows downward
3. Items removed from the stack are not cleared
4. Stack frames track function calls

## Example Stack Frame
### A Stack Frame
![image](https://github.com/ssoxong/ssoxong.github.io/assets/112956015/4525a18f-6ec7-4fa2-8a66-c48f671887e9)


![image](https://github.com/ssoxong/ssoxong.github.io/assets/112956015/b0542f40-4ca4-4794-ad06-361b6fbccec7)


- rbp: 스택의 시작점 (base pointer)
- rsp: 스택의 꼭대기

### A call stack

```c
int main(){
    ...
    foo()
    ...
}

void foo(){
    int i=3;
    bar(i);
    ...
}

void bar(int i){
    int j=2;
    i=5+j;
}
```

![image](https://github.com/ssoxong/ssoxong.github.io/assets/112956015/d1e4c423-5dd3-4c0b-9e67-ddffc860d22c)


1. 호출부의 PC값 저장
2. 지역변수를 위한 공간 예약
3. 변수 할당
4. 함수를 호출하기 위한 매개변수 할당
5. 해당 함수 호출 준비를 위해 호출부의 PC값 저장
6. 지역변수를 위한 공간 예약
7. 변수 할당
8. 함수 실행 (매개변수의 변경)
9. 함수 호출시 지역 + 매개변수 포함하여 리턴

## Code
<details>
<summary>Stack.c</summary>
<div markdown = "1">
    <div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div><div style="line-height:130%">99</div><div style="line-height:130%">100</div><div style="line-height:130%">101</div><div style="line-height:130%">102</div><div style="line-height:130%">103</div><div style="line-height:130%">104</div><div style="line-height:130%">105</div><div style="line-height:130%">106</div><div style="line-height:130%">107</div><div style="line-height:130%">108</div><div style="line-height:130%">109</div><div style="line-height:130%">110</div><div style="line-height:130%">111</div><div style="line-height:130%">112</div><div style="line-height:130%">113</div><div style="line-height:130%">114</div><div style="line-height:130%">115</div><div style="line-height:130%">116</div><div style="line-height:130%">117</div><div style="line-height:130%">118</div><div style="line-height:130%">119</div><div style="line-height:130%">120</div><div style="line-height:130%">121</div><div style="line-height:130%">122</div><div style="line-height:130%">123</div><div style="line-height:130%">124</div><div style="line-height:130%">125</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#0086b3">#include</span>&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&lt;</span>stdio.h<span style="color:#aaffaa"></span><span style="color:#ff3399">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;8,&nbsp;4&nbsp;+&nbsp;1,&nbsp;then&nbsp;round&nbsp;to&nbsp;multiple&nbsp;of&nbsp;4&nbsp;(int's&nbsp;size),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_a&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i;&nbsp;<span style="color:#999999">//&nbsp;4&nbsp;bytes</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c;&nbsp;<span style="color:#999999">//&nbsp;1&nbsp;byte</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[3];&nbsp;//&nbsp;3&nbsp;bytes&nbsp;padding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;16,&nbsp;8&nbsp;+&nbsp;1,&nbsp;then&nbsp;round&nbsp;to&nbsp;multiple&nbsp;of&nbsp;8&nbsp;(long's&nbsp;size),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_b&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">long</span>&nbsp;l;&nbsp;<span style="color:#999999">//&nbsp;8&nbsp;bytes</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c;&nbsp;<span style="color:#999999">//&nbsp;1&nbsp;byte&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[7];&nbsp;//&nbsp;7&nbsp;bytes&nbsp;padding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;24,&nbsp;l&nbsp;need&nbsp;padding&nbsp;by&nbsp;4&nbsp;before&nbsp;it,&nbsp;then&nbsp;round&nbsp;to&nbsp;multiple&nbsp;of&nbsp;8&nbsp;(long's&nbsp;size),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_c&nbsp;{&nbsp;<span style="color:#999999">//가장&nbsp;큰&nbsp;long&nbsp;기준으로&nbsp;allignment&nbsp;(8byte)&nbsp;--&gt;&nbsp;변수&nbsp;선언&nbsp;위치가&nbsp;중요하다다</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i;&nbsp;<span style="color:#999999">//&nbsp;4&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[4];&nbsp;//&nbsp;4&nbsp;bytes&nbsp;padding&nbsp;after&nbsp;int&nbsp;var</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">long</span>&nbsp;l;&nbsp;<span style="color:#999999">//&nbsp;8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c;&nbsp;<span style="color:#999999">//&nbsp;1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[7];&nbsp;//&nbsp;7&nbsp;bytes&nbsp;padding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;16,&nbsp;8&nbsp;+&nbsp;4&nbsp;+&nbsp;1,&nbsp;then&nbsp;round&nbsp;to&nbsp;multiple&nbsp;of&nbsp;8&nbsp;(long's&nbsp;size),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_d&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">long</span>&nbsp;l;&nbsp;<span style="color:#999999">//&nbsp;8&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i;&nbsp;<span style="color:#999999">//&nbsp;4</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c;&nbsp;<span style="color:#999999">//&nbsp;1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[3];</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;16,&nbsp;8&nbsp;+&nbsp;4&nbsp;+&nbsp;1,&nbsp;then&nbsp;round&nbsp;to&nbsp;multiple&nbsp;of&nbsp;8&nbsp;(double's&nbsp;size),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_e&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">double</span>&nbsp;d;&nbsp;<span style="color:#999999">//&nbsp;8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i;&nbsp;<span style="color:#999999">//&nbsp;4</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c;&nbsp;<span style="color:#999999">//&nbsp;1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad&nbsp;[3];</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;24,&nbsp;d&nbsp;need&nbsp;align&nbsp;to&nbsp;8,&nbsp;then&nbsp;round&nbsp;to&nbsp;multiple&nbsp;of&nbsp;8&nbsp;(double's&nbsp;size),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_f&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i;&nbsp;<span style="color:#999999">//&nbsp;4</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[4];</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">double</span>&nbsp;d;&nbsp;<span style="color:#999999">//&nbsp;8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c;&nbsp;<span style="color:#999999">//&nbsp;1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;char&nbsp;pad[7];</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;4,</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_g&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i;&nbsp;<span style="color:#999999">//4</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;size&nbsp;is&nbsp;8,</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;stu_h&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">long</span>&nbsp;l;&nbsp;<span style="color:#999999">//&nbsp;8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;test&nbsp;-&nbsp;padding&nbsp;within&nbsp;a&nbsp;single&nbsp;struct,&nbsp;실제&nbsp;스택에&nbsp;들어간&nbsp;주소</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">int</span>&nbsp;test_struct_padding()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"구조체&nbsp;size\n"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_a"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_a));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_b"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_b));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_c"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_c));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_d"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_d));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_e"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_e));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_f"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_f));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_g"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_g));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_h"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_h));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;<span style="color:#c10aff">0</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;test&nbsp;-&nbsp;address&nbsp;of&nbsp;struct,</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">int</span>&nbsp;test_struct_address()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"\n구조체&nbsp;주소\n"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_g"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_g));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_h"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_h));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"stu_f"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(<span style="color:#ff3399">struct</span>&nbsp;stu_f));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">struct</span>&nbsp;stu_g&nbsp;g;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">struct</span>&nbsp;stu_h&nbsp;h;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">struct</span>&nbsp;stu_f&nbsp;f1;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">struct</span>&nbsp;stu_f&nbsp;f2;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;x&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">long</span>&nbsp;y&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;%s:&nbsp;%p\n"</span>,&nbsp;<span style="color:#ffd500">"g"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>g);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;%s:&nbsp;%p\n"</span>,&nbsp;<span style="color:#ffd500">"h"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>h);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;%s:&nbsp;%p\n"</span>,&nbsp;<span style="color:#ffd500">"f1"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>f1);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;%s:&nbsp;%p\n"</span>,&nbsp;<span style="color:#ffd500">"f2"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>f2);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;%s:&nbsp;%p\n"</span>,&nbsp;<span style="color:#ffd500">"x"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>x);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;%s:&nbsp;%p\n"</span>,&nbsp;<span style="color:#ffd500">"y"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>y);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;g&nbsp;is&nbsp;only&nbsp;4&nbsp;bytes&nbsp;itself,&nbsp;but&nbsp;distance&nbsp;to&nbsp;next&nbsp;struct&nbsp;is&nbsp;16&nbsp;bytes(on&nbsp;64&nbsp;bit&nbsp;system)&nbsp;or&nbsp;8&nbsp;bytes(on&nbsp;32&nbsp;bit&nbsp;system),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"g"</span>,&nbsp;<span style="color:#ffd500">"h"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>h)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>g));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;h&nbsp;is&nbsp;only&nbsp;8&nbsp;bytes&nbsp;itself,&nbsp;but&nbsp;distance&nbsp;to&nbsp;next&nbsp;struct&nbsp;is&nbsp;16&nbsp;bytes(on&nbsp;64&nbsp;bit&nbsp;system)&nbsp;or&nbsp;8&nbsp;bytes(on&nbsp;32&nbsp;bit&nbsp;system),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"h"</span>,&nbsp;<span style="color:#ffd500">"f1"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>f1)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>h));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;f1&nbsp;is&nbsp;only&nbsp;24&nbsp;bytes&nbsp;itself,&nbsp;but&nbsp;distance&nbsp;to&nbsp;next&nbsp;struct&nbsp;is&nbsp;32&nbsp;bytes(on&nbsp;64&nbsp;bit&nbsp;system)&nbsp;or&nbsp;24&nbsp;bytes(on&nbsp;32&nbsp;bit&nbsp;system),</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"f1"</span>,&nbsp;<span style="color:#ffd500">"f2"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>f2)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>f1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;x&nbsp;is&nbsp;not&nbsp;a&nbsp;struct,&nbsp;and&nbsp;it&nbsp;reuse&nbsp;those&nbsp;empty&nbsp;space&nbsp;between&nbsp;structs,&nbsp;which&nbsp;exists&nbsp;due&nbsp;to&nbsp;padding,&nbsp;e.g&nbsp;between&nbsp;g&nbsp;&amp;&nbsp;h,</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"x"</span>,&nbsp;<span style="color:#ffd500">"f2"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>x)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>f2));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"g"</span>,&nbsp;<span style="color:#ffd500">"x"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>x)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>g));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;y&nbsp;is&nbsp;not&nbsp;a&nbsp;struct,&nbsp;and&nbsp;it&nbsp;reuse&nbsp;those&nbsp;empty&nbsp;space&nbsp;between&nbsp;structs,&nbsp;which&nbsp;exists&nbsp;due&nbsp;to&nbsp;padding,&nbsp;e.g&nbsp;between&nbsp;h&nbsp;&amp;&nbsp;f1,</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"x"</span>,&nbsp;<span style="color:#ffd500">"y"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>y)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>x));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"space&nbsp;between&nbsp;%s&nbsp;and&nbsp;%s:&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ffd500">"h"</span>,&nbsp;<span style="color:#ffd500">"y"</span>,&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>y)&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">-</span>&nbsp;(<span style="color:#4be6fa">long</span>)(<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>h));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;<span style="color:#c10aff">0</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">int</span>&nbsp;main(<span style="color:#4be6fa">int</span>&nbsp;argc,&nbsp;<span style="color:#4be6fa">char</span>&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">*</span>&nbsp;argv[])&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;test_struct_padding();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;test_struct_address();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;<span style="color:#c10aff">0</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>

![image](https://github.com/ssoxong/ssoxong.github.io/assets/112956015/4b8bbdfd-5323-4d75-a75b-5fca11255c83)

</div>
</details>

<details>
<summary>packking.c</summary>
<div markdown="1">

<div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#0086b3">#include</span>&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&lt;</span>stdio.h<span style="color:#aaffaa"></span><span style="color:#ff3399">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//#pragma&nbsp;pack(1)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;A&nbsp;{&nbsp;<span style="color:#999999">//8byte&nbsp;맞춤</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">double</span>&nbsp;d1;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c1;&nbsp;<span style="color:#999999">//1,&nbsp;pad&nbsp;3&nbsp;//pad&nbsp;7</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i1;<span style="color:#999999">//&nbsp;4&nbsp;//pad&nbsp;4&nbsp;--&gt;&nbsp;도&nbsp;가능하나&nbsp;컴파일러는&nbsp;c1,&nbsp;i1패킹한듯&nbsp;/&nbsp;워드단위로&nbsp;불러오니까&nbsp;..</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c2;<span style="color:#999999">//1,&nbsp;pad&nbsp;7</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;double,&nbsp;char,&nbsp;char,&nbsp;int&nbsp;순서로&nbsp;선언하면&nbsp;16byte.&nbsp;char+char+2+int&nbsp;=&gt;&nbsp;8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">struct</span>&nbsp;__attribute__((packed))&nbsp;A_packed&nbsp;{&nbsp;<span style="color:#999999">//A_packed&nbsp;속성으로&nbsp;만들면&nbsp;메모리&nbsp;아끼기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">double</span>&nbsp;d1;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c1;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">int</span>&nbsp;i1;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">char</span>&nbsp;c2;</div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">int</span>&nbsp;main()</div><div style="padding:0 6px; white-space:pre; line-height:130%">{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">struct</span>&nbsp;A&nbsp;a;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">struct</span>&nbsp;A_packed&nbsp;a_p[<span style="color:#c10aff">1</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//struct&nbsp;A_packed&nbsp;a_p[2];&nbsp;//두개가&nbsp;완전히&nbsp;붙어있음(packing)&nbsp;-&nbsp;c&nbsp;compiler&nbsp;default&nbsp;=&nbsp;nonpacking</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"sizeof&nbsp;A&nbsp;=&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(a));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a.d1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>a.d1);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a.c1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>a.c1);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a.i1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>a.i1);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a.c2&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>a.c2);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"sizeof&nbsp;A_packed&nbsp;=&nbsp;%ld\n"</span>,&nbsp;<span style="color:#ff3399">sizeof</span>(a_p));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[0].d1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">0</span>].d1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[0].c1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">0</span>].c1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[0].i1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">0</span>].i1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[0].c2&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">0</span>].c2));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[1].d1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">1</span>].d1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[1].c1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">1</span>].c1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[1].i1&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">1</span>].i1));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">printf</span>(<span style="color:#ffd500">"address&nbsp;of&nbsp;a_p[1].c2&nbsp;=&nbsp;%08x\n"</span>,&nbsp;<span style="color:#aaffaa"></span><span style="color:#ff3399">&amp;</span>(a_p[<span style="color:#c10aff">1</span>].c2));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;<span style="color:#c10aff">0</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>

![image](https://github.com/ssoxong/ssoxong.github.io/assets/112956015/5f0c8cd9-0d9a-402f-91f1-e2eb2af794dc)

</dib>
</details>

<br>

### 구조체

구조체로 선언하면 패딩 없이 연속적인 메모리로 할당된다. 
(변수 타입 간 패딩은 존재함)
int와 char 사이 패딩이 없는 이유 
-> 워드단위로 불러오기 때문에 컴파일러가 패킹하듯.. (시스템 상이)
```c
struct A{
    double d1; //8byte
    char c1; //1byte + padded 3
    int i1; //4byte
    char c2; //1byte + padded 7
}
//24byte

struct A{
    double d1; //8byte
    char c1; //1byte
    char c2; //1byte + padded 2
    int i1; //4byte
}
//16byte

//구조체 변수 선언 순서에 따라 메모리 차이 존재
```

### Packed
메모리를 아끼기 위해 패딩 없이 연속으로 붙이기
```c
struct __attribute__((packed)) A_packed { //A_packed 속성으로 만들면 메모리 아끼기
    double d1; //8
    char c1; //1
    int i1; //4
    char c2; //1
};
//8+1+4+1 = 14byte
```
